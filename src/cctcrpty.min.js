"use strict";const CURRVER="002",RNDS=[];RNDS["001"]=3,RNDS["002"]=3;const process=require("process");class CCTCrypty{constructor(t){this.key=t}GetVer(){return CURRVER}Encrypt(t){let r,n="";for(r=0;r<32;r++)n+=Junk();let e=HKey(this.key,n),i=RNDS[CURRVER],o=t.length;for(t="CCT:"+(""+o).length+o+t,console.log("Rounds = "+i),r=0;r<i;r++){let n=Math.ceil(100*r/i);console.log("Progress: "+n+"%"),t=Encrypt(t,e)}return"CCT:CRYPTY"+CURRVER+n+t}Decrypt(t,r){"CCT:CRYPTY"!==t.substr(0,10)&&(console.log("Error: This file is not encrypted with Crypty"),process.exit(-1)),r=t.substr(10,3);let n=(t=t.substr(13)).substr(0,32);t=t.substr(32);let e,i=HKey(this.key,n),o=RNDS[r];for(e=0;e<o;e++){t=Decrypters[r](t,i)}return t=Finalize[r](t)}}var CryptoJS=CryptoJS||function(t,r){var n={},e=n.lib={},i=function(){},o=e.Base={extend:function(t){i.prototype=this;var r=new i;return t&&r.mixIn(t),r.hasOwnProperty("init")||(r.init=function(){r.$super.init.apply(this,arguments)}),r.init.prototype=r,r.$super=this,r},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var r in t)t.hasOwnProperty(r)&&(this[r]=t[r]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},s=e.WordArray=o.extend({init:function(t,r){t=this.words=t||[],this.sigBytes=null!=r?r:4*t.length},toString:function(t){return(t||a).stringify(this)},concat:function(t){var r=this.words,n=t.words,e=this.sigBytes;if(t=t.sigBytes,this.clamp(),e%4)for(var i=0;i<t;i++)r[e+i>>>2]|=(n[i>>>2]>>>24-i%4*8&255)<<24-(e+i)%4*8;else if(65535<n.length)for(i=0;i<t;i+=4)r[e+i>>>2]=n[i>>>2];else r.push.apply(r,n);return this.sigBytes+=t,this},clamp:function(){var r=this.words,n=this.sigBytes;r[n>>>2]&=4294967295<<32-n%4*8,r.length=t.ceil(n/4)},clone:function(){var t=o.clone.call(this);return t.words=this.words.slice(0),t},random:function(r){for(var n=[],e=0;e<r;e+=4)n.push(4294967296*t.random()|0);return new s.init(n,r)}}),h=n.enc={},a=h.Hex={stringify:function(t){var r=t.words;t=t.sigBytes;for(var n=[],e=0;e<t;e++){var i=r[e>>>2]>>>24-e%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(t){for(var r=t.length,n=[],e=0;e<r;e+=2)n[e>>>3]|=parseInt(t.substr(e,2),16)<<24-e%8*4;return new s.init(n,r/2)}},u=h.Latin1={stringify:function(t){var r=t.words;t=t.sigBytes;for(var n=[],e=0;e<t;e++)n.push(String.fromCharCode(r[e>>>2]>>>24-e%4*8&255));return n.join("")},parse:function(t){for(var r=t.length,n=[],e=0;e<r;e++)n[e>>>2]|=(255&t.charCodeAt(e))<<24-e%4*8;return new s.init(n,r)}},l=h.Utf8={stringify:function(t){try{return decodeURIComponent(escape(u.stringify(t)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(t){return u.parse(unescape(encodeURIComponent(t)))}},c=e.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=l.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(r){var n=this._data,e=n.words,i=n.sigBytes,o=this.blockSize,h=i/(4*o);if(r=(h=r?t.ceil(h):t.max((0|h)-this._minBufferSize,0))*o,i=t.min(4*r,i),r){for(var a=0;a<r;a+=o)this._doProcessBlock(e,a);a=e.splice(0,r),n.sigBytes-=i}return new s.init(a,i)},clone:function(){var t=o.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});e.Hasher=c.extend({cfg:o.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){c.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(r,n){return new t.init(n).finalize(r)}},_createHmacHelper:function(t){return function(r,n){return new f.HMAC.init(t,n).finalize(r)}}});var f=n.algo={};return n}(Math);!function(t){var r,n=(r=CryptoJS).lib,e=n.Base,i=n.WordArray;(r=r.x64={}).Word=e.extend({init:function(t,r){this.high=t,this.low=r}}),r.WordArray=e.extend({init:function(t,r){t=this.words=t||[],this.sigBytes=null!=r?r:8*t.length},toX32:function(){for(var t=this.words,r=t.length,n=[],e=0;e<r;e++){var o=t[e];n.push(o.high),n.push(o.low)}return i.create(n,this.sigBytes)},clone:function(){for(var t=e.clone.call(this),r=t.words=this.words.slice(0),n=r.length,i=0;i<n;i++)r[i]=r[i].clone();return t}})}(),function(){function t(){return e.create.apply(e,arguments)}for(var r=CryptoJS,n=r.lib.Hasher,e=(o=r.x64).Word,i=o.WordArray,o=r.algo,s=[t(1116352408,3609767458),t(1899447441,602891725),t(3049323471,3964484399),t(3921009573,2173295548),t(961987163,4081628472),t(1508970993,3053834265),t(2453635748,2937671579),t(2870763221,3664609560),t(3624381080,2734883394),t(310598401,1164996542),t(607225278,1323610764),t(1426881987,3590304994),t(1925078388,4068182383),t(2162078206,991336113),t(2614888103,633803317),t(3248222580,3479774868),t(3835390401,2666613458),t(4022224774,944711139),t(264347078,2341262773),t(604807628,2007800933),t(770255983,1495990901),t(1249150122,1856431235),t(1555081692,3175218132),t(1996064986,2198950837),t(2554220882,3999719339),t(2821834349,766784016),t(2952996808,2566594879),t(3210313671,3203337956),t(3336571891,1034457026),t(3584528711,2466948901),t(113926993,3758326383),t(338241895,168717936),t(666307205,1188179964),t(773529912,1546045734),t(1294757372,1522805485),t(1396182291,2643833823),t(1695183700,2343527390),t(1986661051,1014477480),t(2177026350,1206759142),t(2456956037,344077627),t(2730485921,1290863460),t(2820302411,3158454273),t(3259730800,3505952657),t(3345764771,106217008),t(3516065817,3606008344),t(3600352804,1432725776),t(4094571909,1467031594),t(275423344,851169720),t(430227734,3100823752),t(506948616,1363258195),t(659060556,3750685593),t(883997877,3785050280),t(958139571,3318307427),t(1322822218,3812723403),t(1537002063,2003034995),t(1747873779,3602036899),t(1955562222,1575990012),t(2024104815,1125592928),t(2227730452,2716904306),t(2361852424,442776044),t(2428436474,593698344),t(2756734187,3733110249),t(3204031479,2999351573),t(3329325298,3815920427),t(3391569614,3928383900),t(3515267271,566280711),t(3940187606,3454069534),t(4118630271,4000239992),t(116418474,1914138554),t(174292421,2731055270),t(289380356,3203993006),t(460393269,320620315),t(685471733,587496836),t(852142971,1086792851),t(1017036298,365543100),t(1126000580,2618297676),t(1288033470,3409855158),t(1501505948,4234509866),t(1607167915,987167468),t(1816402316,1246189591)],h=[],a=0;80>a;a++)h[a]=t();o=o.SHA512=n.extend({_doReset:function(){this._hash=new i.init([new e.init(1779033703,4089235720),new e.init(3144134277,2227873595),new e.init(1013904242,4271175723),new e.init(2773480762,1595750129),new e.init(1359893119,2917565137),new e.init(2600822924,725511199),new e.init(528734635,4215389547),new e.init(1541459225,327033209)])},_doProcessBlock:function(t,r){for(var n=(c=this._hash.words)[0],e=c[1],i=c[2],o=c[3],a=c[4],u=c[5],l=c[6],c=c[7],f=n.high,g=n.low,p=e.high,y=e.low,d=i.high,w=i.low,S=o.high,C=o.low,v=a.high,b=a.low,R=u.high,_=u.low,m=l.high,B=l.low,A=c.high,H=c.low,x=f,k=g,J=p,z=y,D=d,E=w,T=S,I=C,U=v,P=b,F=R,M=_,j=m,W=B,N=A,V=H,O=0;80>O;O++){var Y=h[O];if(16>O)var K=Y.high=0|t[r+2*O],X=Y.low=0|t[r+2*O+1];else{K=((X=(K=h[O-15]).high)>>>1|(q=K.low)<<31)^(X>>>8|q<<24)^X>>>7;var q=(q>>>1|X<<31)^(q>>>8|X<<24)^(q>>>7|X<<25),G=((X=(G=h[O-2]).high)>>>19|(L=G.low)<<13)^(X<<3|L>>>29)^X>>>6,L=(L>>>19|X<<13)^(L<<3|X>>>29)^(L>>>6|X<<26),Q=(X=h[O-7]).high,Z=($=h[O-16]).high,$=$.low;K=(K=(K=K+Q+((X=q+X.low)>>>0<q>>>0?1:0))+G+((X=X+L)>>>0<L>>>0?1:0))+Z+((X=X+$)>>>0<$>>>0?1:0);Y.high=K,Y.low=X}Q=U&F^~U&j,$=P&M^~P&W,Y=x&J^x&D^J&D;var tt=k&z^k&E^z&E,rt=(q=(x>>>28|k<<4)^(x<<30|k>>>2)^(x<<25|k>>>7),G=(k>>>28|x<<4)^(k<<30|x>>>2)^(k<<25|x>>>7),(L=s[O]).high),nt=L.low;Z=N+((U>>>14|P<<18)^(U>>>18|P<<14)^(U<<23|P>>>9))+((L=V+((P>>>14|U<<18)^(P>>>18|U<<14)^(P<<23|U>>>9)))>>>0<V>>>0?1:0),N=j,V=W,j=F,W=M,F=U,M=P,U=T+(Z=(Z=(Z=Z+Q+((L=L+$)>>>0<$>>>0?1:0))+rt+((L=L+nt)>>>0<nt>>>0?1:0))+K+((L=L+X)>>>0<X>>>0?1:0))+((P=I+L|0)>>>0<I>>>0?1:0)|0,T=D,I=E,D=J,E=z,J=x,z=k,x=Z+(Y=q+Y+((X=G+tt)>>>0<G>>>0?1:0))+((k=L+X|0)>>>0<L>>>0?1:0)|0}g=n.low=g+k,n.high=f+x+(g>>>0<k>>>0?1:0),y=e.low=y+z,e.high=p+J+(y>>>0<z>>>0?1:0),w=i.low=w+E,i.high=d+D+(w>>>0<E>>>0?1:0),C=o.low=C+I,o.high=S+T+(C>>>0<I>>>0?1:0),b=a.low=b+P,a.high=v+U+(b>>>0<P>>>0?1:0),_=u.low=_+M,u.high=R+F+(_>>>0<M>>>0?1:0),B=l.low=B+W,l.high=m+j+(B>>>0<W>>>0?1:0),H=c.low=H+V,c.high=A+N+(H>>>0<V>>>0?1:0)},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,e=8*t.sigBytes;return r[e>>>5]|=128<<24-e%32,r[30+(e+128>>>10<<5)]=Math.floor(n/4294967296),r[31+(e+128>>>10<<5)]=n,t.sigBytes=4*r.length,this._process(),this._hash.toX32()},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t},blockSize:32}),r.SHA512=n._createHelper(o),r.HmacSHA512=n._createHmacHelper(o)}();var junk="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function Junk(){let t=junk.length,r=Math.floor(Math.random()*t);return junk[r]}function SetCharAt(t,r,n){if(r>t.length-1)return t;return t.substr(0,r)+n+t.substr(r+1)}function HKey(t,r){let n=CryptoJS.SHA512(r+t).toString(),e=CryptoJS.SHA512(t+n).toString(),i=CryptoJS.SHA512(e+t).toString(),o=CryptoJS.SHA512(t+i).toString(),s=Roll(n+e+i+o),h=CryptoJS.SHA512(s+r).toString(),a=CryptoJS.SHA512(t+i).toString(),u=CryptoJS.SHA512(s+h).toString();return s=e+CryptoJS.SHA512(u+t).toString()+n+u+i+a+o+h}function Roll(t){let r=t.substr(0,1);return t=t.substr(1)+r}function Encrypt(t,r){var n,e="";let i=Buffer.from(r,"hex");for(n=0;n<t.length;n+=256){let r,o=t.substr(n,256);for(r=o.length;r<256;){o+=Junk(),r++}for(r=0;r<512;r+=2){let t=i[r],n=i[r+1],e=o.substr(t,1),s=o.substr(n,1);e=String.fromCharCode(e.charCodeAt(0)^n),o=SetCharAt(o,t,s=String.fromCharCode(s.charCodeAt(0)^t)),o=SetCharAt(o,n,e)}e+=o}return e}junk=",.?@ abcdefghijklmnopqrstuvwxyz01234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ";var Decrypters=[],Finalize=[];Decrypters["001"]=function(t,r){var n,e=511,i="";let o=Buffer.from(r,"hex"),s=Buffer.alloc(512);for(n=0;n<512;n++)s[n]=o[e--];for(n=0;n<t.length;n+=256){let r,e=t.substr(n,256);for(r=0;r<512;r+=2){let t=s[r],n=s[r+1],i=e.substr(t,1),o=e.substr(n,1);i=String.fromCharCode(i.charCodeAt(0)^t),e=SetCharAt(e,t,o=String.fromCharCode(o.charCodeAt(0)^n)),e=SetCharAt(e,n,i)}i+=e}return i},Finalize["001"]=function(t){let r=parseInt(t.substr(0,1)),n=parseInt(t.substr(1,r));return t.substr(1+r,n)},Decrypters["002"]=Decrypters["001"],Finalize["002"]=function(t){if("CCT:"!=t.substr(0,4))return console.log("ERROR: Unable to correctly decrypt the file with the given key"),null;{t=t.substr(4);let r=parseInt(t.substr(0,1)),n=parseInt(t.substr(1,r));return t.substr(1+r,n)}},module&&module.exports&&(module.exports=function(t){return new CCTCrypty(t)});